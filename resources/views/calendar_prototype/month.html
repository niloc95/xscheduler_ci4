<!DOCTYPE html>
<html lang="en" data-theme="light" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Month View Prototype</title>
    <link rel="stylesheet" href="/resources/css/calendar/tailwind-prototype.css">
</head>
<body class="min-h-screen bg-[#FDF7E3] px-6 py-10 text-slate-900 transition dark:bg-[#1F2937] dark:text-white/90">
    <div class="mx-auto max-w-6xl rounded-3xl border border-slate-200/80 bg-white/95 p-6 shadow-xl dark:border-slate-800 dark:bg-slate-900/90">
        <header class="mb-6 flex flex-wrap items-center justify-between gap-4">
            <!DOCTYPE html>
            <html lang="en" data-theme="light" class="h-full">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Month View Prototype</title>
                <script type="importmap">
                    {
                        "imports": {
                            "luxon": "https://cdn.jsdelivr.net/npm/luxon@3.4.4/+esm"
                        }
                    }
                </script>
                <link rel="stylesheet" href="../../css/calendar/tailwind-prototype.css">
            </head>
            <body class="min-h-screen bg-[#FDF7E3] px-6 py-10 text-slate-900 transition dark:bg-[#1F2937] dark:text-white/90">
                <div class="mx-auto max-w-6xl rounded-3xl border border-slate-200/80 bg-white/95 p-6 shadow-xl dark:border-slate-800 dark:bg-slate-900/90">
                    <header class="mb-6 flex flex-wrap items-center justify-between gap-4">
                        <div>
                            <div class="text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400">Mounted inside shell header</div>
                            <div class="text-2xl font-semibold tracking-tight text-[#003049] dark:text-white" data-month-label>January 2026</div>
                        </div>
                        <div class="rounded-full bg-[#003049]/10 px-4 py-1 text-xs font-semibold uppercase tracking-wider text-[#003049] dark:bg-blue-500/20 dark:text-blue-100" data-today-label>Today: Jan 24</div>
                    </header>

                    <div class="grid grid-cols-7 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400">
                        <div class="pb-3">Sun</div>
                        <div class="pb-3">Mon</div>
                        <div class="pb-3">Tue</div>
                        <div class="pb-3">Wed</div>
                        <div class="pb-3">Thu</div>
                        <div class="pb-3">Fri</div>
                        <div class="pb-3">Sat</div>
                    </div>

                    <div class="grid grid-cols-7 gap-2 rounded-3xl border border-slate-200/80 bg-white/90 p-3 dark:border-slate-800 dark:bg-slate-900/80" data-month-grid></div>
                </div>

                <script type="module">
                    import { calendarStore, boundActions, selectors } from '/resources/js/modules/calendar/state/index.js';
                    import { samplePayload } from '/resources/js/modules/calendar/state/fixtures/samplePayload.js';
                    import { getProviderTheme, formatRangeLabel, formatFullDate } from '/resources/js/modules/calendar/prototype-helpers.js';

                    boundActions.hydrate(samplePayload, { source: 'month-prototype' });

                    const gridEl = document.querySelector('[data-month-grid]');
                    const monthLabel = document.querySelector('[data-month-label]');
                    const todayLabel = document.querySelector('[data-today-label]');

                    const unsubscribe = calendarStore.subscribe(render);
                    render();

                    function render() {
                        const state = calendarStore.getState();
                        monthLabel.textContent = formatRangeLabel(state.meta.rangeStart);
                        todayLabel.textContent = `Today: ${formatFullDate(new Date().toISOString())}`;
                        const matrix = selectors.selectMonthMatrix(state);
                        gridEl.innerHTML = matrix.flat().map(cell => renderCell(cell, state)).join('');
                    }

                    function renderCell(cell, state) {
                        const classes = [
                            'relative flex min-h-[130px] flex-col rounded-2xl border border-transparent bg-white p-3 text-xs transition dark:bg-slate-800',
                            cell.isToday ? 'border-[#003049]/60 shadow-lg shadow-[#003049]/10' : '',
                            cell.isWeekend ? 'bg-[#F7EFE0]' : '',
                            cell.isCurrentMonth ? '' : 'opacity-60',
                        ].join(' ');

                        const chips = cell.appointmentChips.map(chip => {
                            const provider = state.providers[chip.providerId];
                            const theme = getProviderTheme(provider);
                            return `
                                <div class="flex items-center gap-2 rounded-xl border ${theme.chipBorder} ${theme.chipBg} px-2 py-1 ${theme.chipText}">
                                    <span class="inline-flex h-2 w-2 rounded-full ${theme.dot}"></span>
                                    <span>${chip.label} • ${chip.timeLabel}</span>
                                </div>
                            `;
                        }).join('');

                        const overflow = cell.overflowCount
                            ? `<div class="rounded-xl border border-dashed border-slate-300 px-2 py-1 text-slate-400 dark:border-slate-600 dark:text-slate-500">+${cell.overflowCount} more</div>`
                            : '';

                        return `
                            <div class="${classes}">
                                <div class="flex items-center justify-between text-[11px] font-semibold text-slate-500 dark:text-slate-300">
                                    <span>${cell.date.split('-')[2]}</span>
                                    ${cell.isToday ? '<span class="rounded-full border border-[#003049] px-2 py-0.5 text-[10px] text-[#003049]">Today</span>' : ''}
                                </div>
                                <div class="mt-2 space-y-1">
                                    ${chips || '<div class="text-xs text-slate-400">No appointments</div>'}
                                    ${overflow}
                                </div>
                            </div>
                        `;
                    }

                    window.addEventListener('beforeunload', unsubscribe);
                </script>
            </body>
            </html>
            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">9</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">10</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">11</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">12</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">13</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">14</div>
            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">15</div>

            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">16</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">17</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">18</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">19</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">20</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">21</div>
            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">22</div>

            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">23</div>
            <div class="relative flex min-h-[130px] flex-col rounded-2xl border border-transparent bg-[#FBF1D0] p-3 text-xs dark:bg-slate-800">
                <div class="flex items-center justify-between text-[11px] font-semibold text-slate-500 dark:text-slate-300">
                    <span class="rounded-full bg-white/70 px-2 py-0.5 text-[10px] uppercase tracking-wide text-slate-500 dark:bg-slate-700 dark:text-slate-200">Thu</span>
                    <span class="rounded-full border border-[#003049]/30 px-2 py-0.5 text-[#003049] dark:border-blue-300/40 dark:text-blue-100">Today</span>
                </div>
                <div class="mt-2 space-y-1 text-[11px]">
                    <div class="flex items-center gap-2 rounded-xl border border-blue-100 bg-blue-50 px-2 py-1 text-blue-900 dark:border-blue-500/30 dark:bg-blue-500/20 dark:text-blue-100">
                        <span class="inline-flex h-2 w-2 rounded-full bg-blue-500"></span>
                        <span>Dr. Smith • 10:30a</span>
                    </div>
                    <div class="flex items-center gap-2 rounded-xl border border-emerald-100 bg-emerald-50 px-2 py-1 text-emerald-900 dark:border-emerald-500/30 dark:bg-emerald-500/20 dark:text-emerald-100">
                        <span class="inline-flex h-2 w-2 rounded-full bg-emerald-500"></span>
                        <span>Consult • 1:00p</span>
                    </div>
                    <div class="rounded-xl border border-dashed border-slate-300 px-2 py-1 text-slate-400 dark:border-slate-600 dark:text-slate-500">+3 more</div>
                </div>
                <span class="absolute inset-x-3 bottom-3 text-[10px] font-semibold uppercase tracking-wide text-slate-400 dark:text-slate-500">24</span>
            </div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">25</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">26</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">27</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">28</div>
            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">29</div>

            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">30</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">31</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">1</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">2</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">3</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">4</div>
            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">5</div>

            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">6</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">7</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">8</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">9</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">10</div>
            <div class="rounded-2xl border border-transparent bg-white p-3 text-xs dark:bg-slate-800">11</div>
            <div class="rounded-2xl border border-transparent bg-[#F7EFE0] p-3 text-xs">12</div>
        </div>
    </div>
</body>
</html>
